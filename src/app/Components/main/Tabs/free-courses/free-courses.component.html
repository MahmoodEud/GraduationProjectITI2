<header class="page-header ">
  <div class="header-content">
    <div class="header-icon">
      <i class="fas fa-graduation-cap"></i>
    </div>
    <div class="header-text">
      <h1 class="page-title">الكورسات المجانية</h1>
      <p class="page-description">جميع الكورسات المجانية المتاحة على المنصة.</p>
    </div>
  </div>
  <div class="header-divider"></div>
</header>

<main class="main-content mb-sm-0 py-sm-0 mb-5 py-0 ">
  <div class="container">
    @if (isLoading) {
      <div class="loading-container">
        <div class="loading-spinner">
          <div class="spinner-border text-primary" role="status" aria-label="جاري التحميل">
            <span class="visually-hidden">جاري التحميل...</span>
          </div>
          <p class="loading-text">جاري تحميل الكورسات المجانية...</p>
        </div>
      </div>
    }

    @if (errorMessage && !isLoading) {
      <div class="alert alert-danger error-alert" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        {{ errorMessage }}
      </div>
    }

    @if (!isLoading && !errorMessage && courses.length > 0) {
      <div class="courses-section ">
        <div class="courses-grid mb-sm-0 py-sm-0 mb-5 py-5">
          @for (course of courses; track course.id) {
            <article class="course-wrapper">
              <div class="course-card">
                <!-- Course Image Section -->
                <div class="course-image-wrapper">
                  <img
                    [src]="getImageUrl(course.picturalUrl || 'default.jpg')"
                    [alt]="course.title"
                    class="course-image"
                    (error)="handleImageError($event)"
                    loading="lazy"
                  />
                  
                  <!-- Badges Container -->
                  <div class="badges-container">
                    <span class="price-badge free-badge">
                      <i class="bi bi-gift-fill me-1"></i>
                      <span>مجاني</span>
                    </span>
                    
                    @if (enrolledCourseIds.includes(course.id)) {
                      <span class="enrolled-badge">
                        <i class="bi bi-check-circle-fill me-1"></i>
                        <span>مشترك</span>
                      </span>
                    }
                  </div>

                  <!-- Course Overlay -->
                  <div class="course-overlay">
                    <div class="overlay-content">
                      <i class="bi bi-play-circle-fill play-icon"></i>
                    </div>
                  </div>
                </div>

                <!-- Course Content -->
                <div class="course-content">
                  <header class="course-header">
                    <h2 class="course-title">{{ course.title }}</h2>
                    <p class="course-description">{{ course.description }}...</p>
                  </header>
                  
                  <div class="course-meta">
                    <div class="meta-item">
                      <i class="bi bi-calendar3 me-2"></i>
                      <span class="meta-label">السنة:</span>
                      <span class="meta-value">{{ course.year }}</span>
                    </div>
                  </div>

                  <!-- Action Buttons -->
                  <div class="course-actions">
                    @if (enrolledCourseIds.includes(course.id)) {
                      <button 
                        class="btn btn-unenroll"
                        (click)="unenroll(course.id)"
                        type="button"
                        [attr.aria-label]="'إلغاء التسجيل من كورس ' + course.title"
                      >
                        <i class="bi bi-trash me-2"></i>
                        <span class="btn-text">إلغاء التسجيل</span>
                      </button>
                    } @else {
                      <button 
                        class="btn btn-enroll"
                        (click)="enroll(course.id)"
                        type="button"
                        [attr.aria-label]="'التسجيل في كورس ' + course.title"
                      >
                        <i class="bi bi-person-plus me-2"></i>
                        <span class="btn-text">تسجيل مجاني</span>
                      </button>
                    }
                    <a 
                      [routerLink]="['/courses', course.id]" 
                      class="btn btn-details"
                      [attr.aria-label]="'عرض تفاصيل كورس ' + course.title"
                    >
                      <i class="bi bi-eye me-2"></i>
                      <span class="btn-text">عرض التفاصيل</span>
                    </a>
                  </div>
                </div>
              </div>
            </article>
          }
        </div>
      </div>
    } @else if (!isLoading && !errorMessage) {
      <div class="empty-state-container">
        <div class="empty-state">
          <div class="empty-icon">
            <i class="fas fa-graduation-cap"></i>
          </div>
          <h3 class="empty-title">لا توجد كورسات مجانية متاحة حالياً</h3>
          <p class="empty-description">
            نعمل على إضافة المزيد من الكورسات المجانية قريباً
          </p>
          <div class="empty-actions">
            <button class="btn btn-refresh"  type="button">
              <i class="bi bi-arrow-clockwise me-2"></i>
              تحديث الصفحة
            </button>
          </div>
        </div>
      </div>
    }
  </div>
</main>