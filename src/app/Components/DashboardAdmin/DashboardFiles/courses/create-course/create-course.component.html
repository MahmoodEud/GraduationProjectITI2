<h4 class="text-center text-primary my-3">إنشاء كورس جديد</h4>
<hr />

@if (serverError) {
  <div class="alert alert-danger text-center">{{ serverError }}</div>
}

<form class="card shadow-sm p-3 border-2 rounded-4"
      [ngClass]="{ 'opacity-50': submitting }"
      (ngSubmit)="submit()" [formGroup]="form" novalidate>

  <div class="row g-3">
    <div class="col-md-6">
      <label class="form-label">العنوان</label>
      <input class="form-control" formControlName="Title" placeholder="مثال: كورس نحو 1" />
      @if (form.controls.Title.touched && form.controls.Title.invalid) {
        <small class="text-danger">العنوان مطلوب وبحد أقصى 50 حرفًا</small>
      }
    </div>

    <div class="col-md-6">
      <label class="form-label">التصنيف</label>
      <input class="form-control" formControlName="Category" placeholder="مثال: نحو" />
      @if (form.controls.Category.touched && form.controls.Category.invalid) {
        <small class="text-danger">التصنيف مطلوب (حتى 50 حرفًا)</small>
      }
    </div>

    <div class="col-md-4">
      <label class="form-label">السنة</label>
      <select class="form-select" formControlName="Year">
        <option [value]="1">الأولى</option>
        <option [value]="2">الثانية</option>
        <option [value]="3">الثالثة</option>
        <option [value]="4">الرابعة</option>
      </select>
    </div>

    <div class="col-md-4">
      <label class="form-label">السعر</label>
      <input type="number" class="form-control" formControlName="Price" min="0" step="1" />
      @if (form.controls.Price.touched && form.controls.Price.invalid) {
        <small class="text-danger">السعر مطلوب ويجب أن يكون رقمًا ≥ 0</small>
      }
    </div>

    <div class="col-md-4">
      <label class="form-label">الحالة</label>
      <div class="form-check form-switch mt-2">
        <input class="form-check-input" type="checkbox" role="switch" id="statusSwitch" formControlName="Status">
        <label class="form-check-label" for="statusSwitch">{{ form.value.Status ? 'متاح' : 'غير متاح' }}</label>
      </div>
    </div>

    <div class="col-12">
      <label class="form-label">الوصف</label>
      <textarea rows="3" class="form-control" formControlName="Description" placeholder="اكتب وصفًا موجزًا حتى 500 حرف"></textarea>
      @if (form.controls.Description.touched && form.controls.Description.invalid) {
        <small class="text-danger">الوصف مطلوب (حتى 500 حرف)</small>
      }
    </div>

    <div class="col-md-6">
      <label class="form-label">صورة الكورس</label>
      <input type="file" class="form-control" accept="image/*" (change)="onFileChange($event)" />
      <small class="text-muted">اختياري. لو لم تُحدّد صورة سيتم وضع صورة افتراضية.</small>
    </div>

    <div class="col-md-6 d-flex align-items-end">
      @if (previewUrl) {
        <img [src]="previewUrl!" alt="معاينة" class="rounded-3 border"
             style="height: 120px; object-fit: cover; width: 100%; max-width: 220px;">
      }
    </div>
  </div>

  <div class="d-flex justify-content-end gap-2 mt-3">
    <button class="btn btn-secondary" type="reset" [disabled]="submitting">تفريغ</button>
    <button class="btn btn-primary" type="submit" [disabled]="submitting">
      @if (submitting) { <span class="spinner-border spinner-border-sm me-1" aria-hidden="true"></span> }
      إنشاء
    </button>
  </div>
</form>
